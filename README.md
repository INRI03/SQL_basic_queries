Цели домашнего задания:

закрепить на практике знания по функциям агрегации и группировке строк;
научиться фильтровать сгруппированные строки;
закрепить навыки использования методов соединения таблиц с помощью разных вариаций JOIN.
Перечень заданий

Основная часть

Задание 1. Выведите для каждого покупателя его адрес, город и страну проживания.


Задание 2. С помощью SQL-запроса посчитайте для каждого магазина количество его покупателей.

Доработайте запрос и выведите только те магазины, у которых количество покупателей больше 300. Для решения используйте фильтрацию по сгруппированным строкам с функцией агрегации. Ожидаемый результат запроса: letsdocode.ru.../3-2-2.png
Доработайте запрос, добавив в него информацию о городе магазина, фамилии и имени продавца, который работает в нём. 

Задание 3. Выведите топ-5 покупателей, которые взяли в аренду за всё время наибольшее количество фильмов.


Задание 4. Посчитайте для каждого покупателя 4 аналитических показателя:

количество взятых в аренду фильмов;
общую стоимость платежей за аренду всех фильмов (значение округлите до целого числа);
минимальное значение платежа за аренду фильма;
максимальное значение платежа за аренду фильма.

Задание 5. Используя данные из таблицы городов, составьте одним запросом всевозможные пары городов так, чтобы в результате не было пар с одинаковыми названиями городов. Для решения необходимо использовать декартово произведение.


Задание 6. Используя данные из таблицы rental о дате выдачи фильма в аренду (поле rental_date) и дате возврата (поле return_date), вычислите для каждого покупателя среднее количество дней, за которые он возвращает фильмы.
